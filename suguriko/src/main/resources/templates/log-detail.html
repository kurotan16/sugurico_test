<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title th:text="${log.title} + ' | スグリコ'">ログ詳細</title>
</head>
<body>
    <!-- ログ本体の表示 -->
    <h1 th:text="${log.title}">ログのタイトル</h1>
    <p>
        投稿者: <span th:text="${log.user.username}"></span> / 
        投稿日時: <span th:text="${#temporals.format(log.createdAt, 'yyyy/MM/dd HH:mm')}"></span>
    </p>
    
    <!-- 画像表示エリア -->
    <div th:if="${not #lists.isEmpty(log.images)}" style="margin: 20px 0; display: flex; flex-wrap: wrap; gap: 10px;">
        <div th:each="image : ${log.images}">
            <img th:src="${image.imageUrl}" alt="ログの画像" style="max-width: 200px; max-height: 200px; object-fit: cover;">
        </div>
    </div>

    <!-- 本文 (CSSで改行を維持して表示) -->
    <p th:text="${log.content}" style="white-space: pre-wrap;">ログの本文</p>

    <hr>

    <!-- コメント投稿フォーム -->
    <h2>コメントを投稿する</h2>
    <form th:action="@{/logs/{logId}/comments(logId=${log.id})}" th:object="${newComment}" method="post">
        <div>
            <textarea th:field="*{content}" rows="3" cols="50" placeholder="コメントを入力..." required></textarea>
        </div>
        <button type="submit">投稿</button>
    </form>
    
    <hr>

    <!-- コメント一覧表示エリア -->
    <h2>コメント一覧</h2>
    <div th:if="${#lists.isEmpty(log.comments)}">
        <p>まだコメントはありません。</p>
    </div>
    <ul th:unless="${#lists.isEmpty(log.comments)}">
        <li th:each="comment : ${log.comments}" style="margin-bottom: 15px; border-bottom: 1px solid #ccc; padding-bottom: 10px;">
            <strong><span th:text="${comment.user.username}"></span></strong>
            <small th:text="${#temporals.format(comment.createdAt, 'yyyy/MM/dd HH:mm')}" style="margin-left: 10px; color: #888;"></small>
            <p th:text="${comment.content}" style="margin-top: 5px;"></p>
        </li>
    </ul>

    <hr>
    <a th:href="@{/}">トップページに戻る</a>

</body>
</html>
